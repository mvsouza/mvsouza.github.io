<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Ultimos posts &#8211; mvsouza</title>
<meta name="description" content="Descreva esse nonsense.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Ultimos posts">
<meta property="og:description" content="Descreva esse nonsense.">
<meta property="og:url" content="https://mvsouza.com/inicio/">
<meta property="og:site_name" content="mvsouza">

<meta name="google-site-verification" content="2121122112">
<meta name="msvalidate.01" content="32312321312213">


<link rel="canonical" href="https://mvsouza.com/inicio/">
<link href="https://mvsouza.com/feed.xml" type="application/atom+xml" rel="alternate" title="mvsouza Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="https://mvsouza.com/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="https://mvsouza.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://mvsouza.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://mvsouza.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://mvsouza.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://mvsouza.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://mvsouza.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://mvsouza.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="https://mvsouza.com/inicio/">Inicio</a></li>
		<li>
			<a href="#">Tradução</a>
			<ul class="dl-submenu">
			
			
			
			
				<li>
			    	<li><a href="https://mvsouza.com" class="en">en</a></li>
			    
			
				
			

			</ul>
		</li>
		<li>
			<a href="#">Sobre</a>
			<ul class="dl-submenu">
				<li>
					<img src="https://mvsouza.com/images/avatar.jpg" alt="Matheus Valiente Souza photo" class="author-photo">
					<h4>Matheus Valiente Souza</h4>
					<p>Programmer.</p>
				</li>
				<li>
					<a href="mailto:mvs@mvsouza.com"><i class="fa fa-envelope"></i> Email</a>
				</li>
				
				<li>
					<a href="https://facebook.com/matheus.valientesouza"><i class="fa fa-facebook"></i> Facebook</a>
				</li>
				
				<li>
					<a href="https://linkedin.com/in/mvsouza"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="https://github.com/mvsouza"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				<li>
					<a href="https://stackexchange.com/users/449767"><i class="fa fa-stack-exchange"></i> Stackexchange</a>
				</li>
				<li>
					<a href="https://instagram.com/matheusvalientesouza"><i class="fa fa-instagram"></i> Instagram</a>
				</li>
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Postagens</a>
			<ul class="dl-submenu">
				<li><a href="https://mvsouza.com/postagens/">Todas Postagens</a></li>
				<li><a href="https://mvsouza.com/marcacoes/">Todas Marcações</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div id="particles-js" class="entry-header">
  <div class="entry-image">
  </div>
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>mvsouza</h1>
      <h2>Ultimos posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div>

<div id="main" role="main">
  

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2019-02-05T00:00:00+00:00"><a href="https://mvsouza.com/event-sourcing-pt/">February 05, 2019</a></time></span><span class="author vcard"><span class="fn"><a href="https://mvsouza.com/about/" title="About Matheus Valiente Souza">Matheus Valiente Souza</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="https://mvsouza.com/event-sourcing-pt/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://mvsouza.com/event-sourcing-pt/" rel="bookmark" title="Event Sourcing" itemprop="url">Event Sourcing</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I know that you might be tired of reading/hearing about it, and there is enough material on it out there. Still, there are many inconsistencies and misconceptions that might make you fuzzy. So I’ll show you what I see as being the basics and give you good references. If it makes you curious enough, soon I’ll be posting some samples.</p>

<h3 id="concept">Concept</h3>

<p>Erick Evans, on his book about DDD, raises an interesting point about the object’s life cycle and reconstituting stored objects when writing about factories:</p>

<blockquote>
  <p>At some point, most objects get stored in databases or transmitted through a network, and few current database technologies retain the object character of their contents. Most transmission methods <strong>flatten an object</strong> into an even more limited presentation. Therefore, retrieval requires a potentially complex process of reassembling the parts into a live object.<br />
– <cite>Eric Evans</cite></p>
</blockquote>

<p>He is explaining the importance of factories (as ORMs) to recreate objects as they were before being persisted to the database. He argues that there is a great responsibility for these objects when they reconstitute the previous state of a disposed object as they once were.</p>

<p>Although his idea of object’s life cycle could be considered already <strong>flatten</strong> on an event-driven perspective. So we could say <em>Most structural data models <strong>flatten objects</strong> into an even more limited presentation.</em> Due to understanding it better, we should discuss what it means. Consider reading Martin Fowlers<a href="https://martinfowler.com/articles/201701-event-driven.html">article</a> about the subject, where he explains his view about event source (ES):</p>

<blockquote>
  <p>The core idea of event sourcing is that whenever we make a change to the state of a system, we record that state change as an event, and we can confidently rebuild the system state by reprocessing the events at any time in the future. The event store becomes the principal source of truth, and the system state is purely derived from it. For programmers, the best example of this is a version control system. The log of all the commits is the event store and the working copy of the source tree is the system state.<br />
– <cite>Martin Fowler</cite></p>
</blockquote>

<p>In addition to Erick`s view, ES expands the immutability, only covered by Value Objects on DDD, to whole application state, like a shadow. We only <strong>append</strong> facts to the repository. In spite of changing and deleting objects, we create new events that, when applied, remove or change them from the current state.</p>

<h3 id="aplication">Aplication</h3>

<p>As good as it sounds, of course, you might not be already pumped to use it. I’ve just described what it is, not why. Why should you care? After all, if you wanna fix something without nails, a hammer is useless.</p>

<p>I’ve questioned myself that years ago. To answer I had to associate with other concepts first, like distributed computing, DDD, functional programming. Now, I have a view of my own, and I hope to help to build yours.</p>

<p>One of its characteristics is traceability/auditability. Natively, you got the ability to trace all domain changes and easily understand how the application is behaving. Even more, you could easily add user information and audite user changes.</p>

<p>Another important feature it provides is an easy reconciliation. So, when things go south between distributed systems, one can simply ask for what happened to others on a period then process all lost messages.</p>

<p>For these reasons, ES should solve many problems like conflict management and desynchronization on microservice applications that shares business flows and IoT/embedded systems that might work off-line.</p>

<p>There is plenty of real-world applications that would leverage this pattern, like:</p>

<ul>
  <li>Shipment tracker</li>
  <li>IoT systems in general</li>
  <li>Version control systems</li>
  <li>Banking transactions</li>
</ul>

<h3 id="conclusion">Conclusion</h3>

<p>To conclude the pros/cons, I will let Greg Young, who has made the concept popular, anwser that:</p>

<blockquote>
  <h4 id="pros"><strong>Pros</strong></h4>
  <p>Single Event Centric Model<br />
Simplified/Better Testing<br />
Conflict Management</p>

  <h4 id="cons"><strong>Cons</strong></h4>
  <p>Harder to sell to an organization<br />
Less known tools/technologies (though you can implement the Event Store in a RDBMS which kind of mitigates this)<br />
Very difficult to migrate a legacy app to<br />
–<cite><a href="http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/">Greg Young</a></cite></p>
</blockquote>

<h3 id="next-steps">Next steps</h3>

<p>I’ve been working with C# for a while now, so I will be posting some sample soon. But keep in mind that, as Vaught Venom wrote in his book <em>Implementing Domain Driven Design</em>, “ES is inherently functional in nature”, and its use on this paradigm would “potentially lead to more concise code that performs optimally”.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-12-05T00:00:00+00:00"><a href="https://mvsouza.com/encontrando-a-geo-localizacao-de-uma-cidade/">December 05, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="https://mvsouza.com/about/" title="About Matheus Valiente Souza">Matheus Valiente Souza</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="https://mvsouza.com/encontrando-a-geo-localizacao-de-uma-cidade/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~5 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://mvsouza.com/encontrando-a-geo-localizacao-de-uma-cidade/" rel="bookmark" title="Encontrando geo-localização de uma cidade" itemprop="url">Encontrando geo-localização de uma cidade</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Semana passada eu estava procurando uma forma de encontrar a cidade a partir de uma latitude e longitude.
Então aqui esta o que eu aprendi.</p>

<h2 id="circunstncias">Circunstâncias</h2>

<p>NA realidade eu e meu time tropeamos nesse problema pois estamos utilizando os locais da API do Foursquare, que nem sempre prove essa informação, e quando prove pode estar incorreta.
Então eu me debati com algumas soluções não satisfatórias, entre as quais testei as APIs do Geonames, Onpenstreemap e Mapbpx.
Finalmente encontrai o serviço beta do Opencage, que utiliza o Towfishes para reverter o geocode.</p>

<p>Eu estou atualmente usando o mapa do Mapbox map para mostrar os locais do Foursquare, e a API do Geoname para fazer o auto complete do mome cidades no nosso formulário de busca.
Não deveria ser nada difícil, se não fosse pelo fato de não podermos usar a API do Google, pois a seus termos de uso obrigam o uso do seu mapa.</p>

<h2 id="desenvolvendo-o-acesso-s-apis">Desenvolvendo o acesso às APIs</h2>

<p>O senário ideal seria utilizar a API do Geoname, pois o serviço é gratuito e nós já estamos usando, então os nos das cidades seriam similares aos utilizados na pesquisa de locais.</p>

<p>Como já havia experimentado antes, os seus resultados não seguem um padrão ao certo, mas testei novamente para ter certeza.</p>

<p>Como alternativa escolhi testar as APIs do Mapbox, na qual já temos conta, e Openstreetmap, que não necessita de conta.</p>

<p>No intuito de desencolver o teste para as APIs, programei um Webapp com Angular utilizando um template do Yeoman.</p>

<h2 id="implementao">Implementação</h2>

<p>Então eu desenvolvi um serviço que utilizaria todas essa APIs.</p>

<p>Para configurar o serviço, adicionei uma constante para o módulo angular como segue added.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">reverseGeocodeModule</span><span class="p">.</span><span class="nx">constant</span><span class="p">(</span><span class="s1">&#39;GeoAPIConstants&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">mapBoxId</span><span class="o">:</span> <span class="s1">&#39;xxxxxx&#39;</span><span class="p">,</span>
    <span class="nx">geonameId</span><span class="o">:</span> <span class="s1">&#39;xxxxxx&#39;</span><span class="p">,</span>
    <span class="nx">openCage</span><span class="o">:</span> <span class="s1">&#39;xxxxxx&#39;</span>
  <span class="p">});</span></code></pre></div>

<p>Quando desenvolvi o serviço, usei essas constantes para identificar as configurações de ambiente, então não é preciso ficar procurando per todos arquivos para alterar minhas conde acesso.</p>

<p>Veja o serviços.</p>

<h3 id="mapbox">Mapbox</h3>

<p>A WEB API do Mapbox tem <a href="http://api.tiles.mapbox.com/v3/examples.map-zr0njcqy/geocode/-73.989,40.733.json">essa chamada para reverter o geocode</a>.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">reverseGeocodeModule</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;MapboxService&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;$http&#39;</span><span class="p">,</span><span class="s1">&#39;GeoAPIConstants&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">,</span><span class="nx">GeoAPIConstants</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">urls</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span> <span class="o">=</span> <span class="s2">&quot;http://api.tiles.mapbox.com/v3/{0}/geocode/{1},{2}.json&quot;</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">FindCityReverseGeocode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span> <span class="nx">lat</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">GeoAPIConstants</span><span class="p">.</span><span class="nx">mapBoxId</span><span class="p">,</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">));</span>
        <span class="k">return</span> <span class="nx">q</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">self</span><span class="p">.</span><span class="nx">extractCityFromGeocodeJSONResult</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">};</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">extractCityFromGeocodeJSONResult</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">isResultEmpty</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">self</span><span class="p">.</span><span class="nx">searchInMatrixForCity</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">isResultEmpty</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
      <span class="k">return</span> <span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">results</span> <span class="o">||</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">searchInMatrixForCity</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">].</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;city&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}]);</span></code></pre></div>

<h3 id="openstreetmap">Openstreetmap</h3>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">reverseGeocodeModule</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;OpenstreetmapService&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;$http&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">urls</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span> <span class="o">=</span> <span class="s2">&quot;http://nominatim.openstreetmap.org/reverse?format=json&amp;lat={1}&amp;lon={0}&quot;</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">FindCityReverseGeocode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span> <span class="nx">lat</span><span class="p">){</span>
            <span class="k">return</span> <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">));</span>
    <span class="p">};</span>
  <span class="p">}]);</span></code></pre></div>

<h3 id="geonames">Geonames</h3>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">reverseGeocodeModule</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;GeonamesService&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;$http&#39;</span><span class="p">,</span><span class="s1">&#39;GeoAPIConstants&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">,</span><span class="nx">GeoAPIConstants</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">urls</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">urls</span><span class="p">.</span><span class="nx">reverseGeocode</span> <span class="o">=</span> <span class="s2">&quot;http://ws.geonames.org/findNearbyPlaceNameJSON?lat={1}&amp;lng={0}&amp;style=full&amp;username={2}&quot;</span><span class="p">;</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">FindCityReverseGeocode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span> <span class="nx">lat</span><span class="p">){</span>
            <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">urls</span><span class="p">.</span><span class="nx">reverseGeocode</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">,</span><span class="nx">GeoAPIConstants</span><span class="p">.</span><span class="nx">geonameId</span><span class="p">));</span>
            <span class="k">return</span> <span class="nx">q</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
                <span class="kd">var</span> <span class="nx">listResults</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">geonames</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">listResults</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                    <span class="k">if</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="nx">self</span><span class="p">.</span><span class="nx">findFeatureClassIndexFor</span><span class="p">(</span><span class="nx">listResults</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span>
                      <span class="k">return</span> <span class="nx">listResults</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">});</span>
    <span class="p">};</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">findFeatureClassIndexFor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">geolocation</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">featureClassNameList</span> <span class="o">=</span> <span class="nx">geolocation</span><span class="p">.</span><span class="nx">fclName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">featureClassNameList</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">}]);</span></code></pre></div>

<h2 id="soluo-escolhida">Solução escolhida</h2>

<p>Opencage</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">reverseGeocodeModule</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;OpenCageService&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;$http&#39;</span><span class="p">,</span><span class="s1">&#39;GeoAPIConstants&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">,</span><span class="nx">GeoAPIConstants</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">urls</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span> <span class="o">=</span> <span class="s2">&quot;https://api.opencagedata.com/geocode/v1/json?q={1},{0}&amp;pretty=1&amp;key={2}&quot;</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">FindCityGeoCodeReverse</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span> <span class="nx">lat</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">lng</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="nx">lng</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="nx">lng</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">lat</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="nx">lat</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="nx">lat</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">urls</span><span class="p">.</span><span class="nx">geocode</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">,</span><span class="nx">GeoAPIConstants</span><span class="p">.</span><span class="nx">openCage</span><span class="p">));</span>
        <span class="k">return</span> <span class="nx">q</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">){</span>
                    <span class="k">return</span> <span class="nx">r</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">components</span><span class="p">;</span>
        <span class="p">});</span>
      <span class="p">};</span>
  <span class="p">}]);</span></code></pre></div>

<!---
but the analysis of the results were quite disapoiting

-->

<h2 id="prximos-passos">Próximos passos</h2>

<p>A API escolhida esta rodando em versão beta, então considere esse risco. 
Para mitigar esse risco, o próximo passo seria testar a solução Twofishes, que opencage utiliza, para avalia-la como alternativa.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2014-11-08T00:00:00+00:00"><a href="https://mvsouza.com/comecando-com-yeoman/">November 08, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="https://mvsouza.com/about/" title="About Matheus Valiente Souza">Matheus Valiente Souza</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="https://mvsouza.com/comecando-com-yeoman/#disqus_thread">Comment</a></span>
      
      <span class="entry-reading-time pull-right">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="https://mvsouza.com/comecando-com-yeoman/" rel="bookmark" title="Começando com Yeoman" itemprop="url">Começando com Yeoman</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Neste jump start vou mostrar como criar diretivas do Angular usando Yeoman.</p>

<p>Mas antes da parte boa, deixe-me introduzir brevemente o Yeoman, ou apenas pule para <a href="#letsgetdowntoit">parte boa</a>.</p>

<h2 id="whata-hell">What’a hell?</h2>

<p style="text-align:center;">
	<img style="height:" src="https://mvsouza.com/images/yeoman-005.ef68.png" />
</p>

<p>Você pode não saber sobre a existência do Yoeman, como eu não conhecia. Nesse caso você deve estar se perguntando “Que m#$%# é essa?”.
Yeoman é uma ferramente de scaffolding, que ajuda a desenvolvedores a começar seus projetos, especialmente o tipo web. Ele gera código ordinário, incluindo referências de pacotes bower e npm e scripts de task runners como Grunt e Gulp.</p>

<h2 id="e-o-queco">E o queco?</h2>

<p>Na realidade é uma solução bem elegante, pois você pode facilmente configurar um projeto com toda uma estrutura, sem ter que ficar copiando código de outros projetos ou reescrever a mesma balela de sempre.</p>

<p style="text-align:center;">
	<img alt="Copy ain't funny" src="https://mvsouza.com/images/Copying_test-331x285.jpg" />
</p>

<p>Dessa forma aumenta a sua produtividade e, se usada da forma correta, a qualidade do software ao adicionar ferramentas que você deixaria para traz por “atrasar” o “progresso” do projeto.</p>

<p style="text-align:center;">
	<video style="width: 275px;" alt="Ain't got time for that" src="https://mvsouza.com/images/aintgottimeforthat.webm" autoplay="autoplay" loop="loop"> 
		Seu browser não implementa html5 video. 
	</video>
</p>

<p>Já contém uma coleção de geradores, que cobrem uma boa variedade de soluções. Cada qual requer algumas tarefas usuais ligados ao seu proposito, como testes automatizados, build, watch (livereload), e dependências em comum, como AngularJS, Bootstrap.</p>

<p>No intuito de cobrir essas necessidades, pode gerar referencias para pacotes bower e npm e arquivos Grunt ou Gult para rodar tarefas.</p>

<!-- more -->

<p><span name="letsgetdowntoit"></span></p>

<h2 id="letsgetdowntoit">#LetsGetDownToIt</h2>

<p>Precisamos de algumas coisas primeiro:</p>

<ul>
  <li>Instale <a href="https://www.npmjs.org/">NPM</a>, <a href="https://nodejs.org/">nodejs</a> package manager;</li>
  <li>E depois o próprio Yeoman.</li>
</ul>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install -g yo</code></pre></div>

<p alt="Ain't got time for that" style="text-align:center;">
	<video style="width: 275px;" src="https://mvsouza.com/images/lonely_island_michael_bolton_jack_sparrow_back_to_.webm" autoplay="autoplay" loop="loop"> 
		Seu browser não implementa html5 video. 
	</video>
</p>

<p>Agora estamos prontos para começar! Precisamos baixar o gerador do Yeoman para diretiva de Angular.</p>

<p>Você pode encontrar geradores pesquisando no npm por por pacotes com o prefixo “generator”, dessa forma:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm search generator OQueVocêEstaPesquisando</code></pre></div>

<p>Nessa caso em especifico, vamos precisar procurar a diretiva do angular, então pesquisamos dessa forma:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm search generator directive</code></pre></div>

<p>Com o nome do pacote em mãos nós instalamos ele.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install generator-angular-directive -g</code></pre></div>

<p>Os pacotes npm com o prefixo “generator-“ nomeiam templates do yo. Para rodar o gerador recentemente adicionado, nós apenas retiramos o prefixo e passamos como argumento para o Yeoman. Antes disso, garanta que já esta na pasta do projeto.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mkdir ng-yomanDirective
<span class="nb">cd </span>ng-yomanDirective
yo angular-directive</code></pre></div>

<p>Agora que a magica acontece! O Yeoman irá perguntar algumas configurações para gerar de forma mais conveniente o projeto.</p>

<p>Esse template irá o nome que você quer dar para diretiva e o sue nome no github.</p>

<p>Então irá criar a solução com:
* Uma configuração para, rodar os teste e o servidor em em live mode;
* Configuração para Testes automatizados com karma e jasmine;
* configuração para integração continua usando Travis.</p>

<p>Essas são as coisas que você precisa para começar a desenvolver.</p>

<p>Com a solução preparada, rode as seguintes linhas para instalar as dependência:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install -g gulp
npm install -g bower
npm install
bower install</code></pre></div>

<p>Para rodar o live reload demo rode:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">gulp serve</code></pre></div>

<p>E para desenvolver usando TDD, procurando sempre se manter no verde, rode:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">gulp <span class="nb">test</span></code></pre></div>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    Anterior
  
  <ul class="inline-list">
    <li>
      
        <span class="current-page">1</span>
      
    </li>
    
  </ul>
  
    Próxima
  
</div><!-- /.pagination -->
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2019 Matheus Valiente Souza. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://mvsouza.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="https://mvsouza.com/assets/js/scripts.min.js"></script>
<script src="https://mvsouza.com/assets/js/vendor/particles.min.js"></script>
<script>
	particlesJS('particles-js', {
    particles: {
        color: '#fff',
        shape: 'circle', // "circle", "edge" or "triangle"
        opacity: 0.5,
        size: 2,
        size_random: true,
        nb: 70,
        line_linked: {
            enable_auto: true,
            distance: 250,
            color: '#fff',
            opacity: 0.5,
            condensed_mode: {
                enable: true,
                rotateX: 600,
                rotateY: 600
            }
        },
        anim: {
            enable: true,
            speed: 2
        }
    },
    interactivity: {
        enable: true,
        mouse: {
            distance: 200
        },
        mode: 'grab'
    },
    /* Retina Display Support */
    retina_detect: false
});
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-56576468-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-56576468-1');
</script>
          

</body>
</html>